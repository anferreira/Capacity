

select * from               (
/*Standard PO*/
select 
'ST' Type , pi.KBPO# PoNum,  ( pi.kbqtyo - pi.kbqtyr ) as NetQty , pi.KBQTYR QtyReceived, KAODAT as HDate,  pi.KBRDAT DDate,pi.KBPT# Part
 from cmsdat.POH as ph , cmsdat.POI as pi       
where ph.KAOTYP =  'S'  AND  ph.KAOSTS  in ('C','H') and ph.KAPO# = pi.KBPO#

  and (pi.KBRDAT >= ((current date) + (7 - dayofweek(current date) + (-1 * 7 + 2)) days)  
  and  pi.KBRDAT <= ((current date) + (7 - dayofweek(current date) + ( 0 * 7 + 1)) days)) 

union 
/*Blanket*/
select   
'BL' Type ,pori.KGPO# PoNum,  ( pori.kgqtyo - pori.kgqtyr ) as NetQty , pori.kgqtyr  QtyReceived, KAODAT as HDate,  pori.KGRDAT DDate,pori.KGPT# Part

from cmsdat.POH as ph , cmsdat.pori as pori 
where
ph.KAPO# = pori.KGPO# and ph.KAOTYP  = 'B'  AND    ph.KAOSTS not in ('C','H' ) and pori.KGISTS  <> 'C' 

union

select
'CB' Type ,prh.KLPO# PoNum,  ( prd.KMQTYR ) as NetQty , prd.KMQTYR QtyReceived, prh.KLSDAT as HDate, prd.KMSDAT DDate ,prh.KLPT# Part
from cmsdat.POPRH prh , cmsdat.POPRD prd
where 
prh.KLPO# = prd.KMPO#   
and prh.KLITM#=prd.KMITM#  
and prh.KLCREL=prd.KMRELN  
and prh.KLCRCM = '1'  
and  prd.KMQTYR <> 0

) as query

where        Part='HIN0420' and
       (DDate >= ((current date) + (7 - dayofweek(current date) + (-1 * 7 + 2)) days)  
 and  DDate <= ((current date) + (7 - dayofweek(current date) + ( 0 * 7 + 1)) days)) 